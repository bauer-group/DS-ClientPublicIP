services:

  clientpublicip-server:
    build:
      context: ./src
      dockerfile: Dockerfile
    container_name: clientpublicip_development_server
    environment:
      - TZ=UTC
      - SERVICE_HOSTNAME=localhost
      - RATE_LIMIT=1000/minute
      - SERVER_PORT=8080

      - FLASK_ENV=development
      - FLASK_DEBUG=1
    expose:
      - 8080/tcp      
    ports:
      - 8080:8080/tcp
    volumes:
      - ./src/app.py:/app/app.py:ro
      - ./src/templates:/app/templates:ro
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:8080/raw"]
      interval: 10s
      timeout: 3s
      start_period: 5s
      retries: 3
